<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Smart Parking Slot S1</title>
<style>
  body {font-family: 'Segoe UI', sans-serif; margin:0; background:#f4f6f8; color:#1f2937;}
  header {background:#1e40af; color:white; padding:16px; text-align:center;}
  header h1 {margin:0; font-size:22px;}
  .container {max-width:800px; margin:20px auto; padding:0 16px;}
  .card {background:white; padding:20px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-bottom:20px;}
  .status {font-weight:700; padding:5px 12px; border-radius:999px;}
  .status.free {background:#d1fae5; color:#065f46;}
  .status.booked {background:#fef3c7; color:#78350f;}
  .status.occupied {background:#fee2e2; color:#991b1b;}
  label {font-weight:600; display:block; margin-top:12px;}
  input {width:100%; padding:8px 10px; margin-top:4px; border-radius:8px; border:1px solid #cbd5e1;}
  button {margin-top:12px; padding:10px 16px; background:#1e40af; color:white; border:none; border-radius:8px; cursor:pointer;}
  button:disabled {opacity:0.6; cursor:not-allowed;}
  #map {width:100%; height:300px; border-radius:12px; margin-top:16px;}
</style>
</head>
<body>
<header>
  <h1>ðŸš— Smart Parking â€” Slot S1</h1>
</header>

<div class="container">
  <div class="card" id="slotCard"></div>

  <div class="card">
    <label for="location">Set Location:</label>
    <input type="text" id="location" placeholder="e.g., Nairobi CBD, Kenyatta Avenue">
    <button onclick="updateMap()">Show on Map</button>
    <div id="map"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-database-compat.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyC83XNFywh1cxT-0ty6pM9d_mIevHUzI74",
  authDomain: "smartparkingsystem-55a05.firebaseapp.com",
  databaseURL: "https://smartparkingsystem-55a05-default-rtdb.firebaseio.com",
  projectId: "smartparkingsystem-55a05",
  storageBucket: "smartparkingsystem-55a05.firebasestorage.app",
  messagingSenderId: "200855735860",
  appId: "1:200855735860:web:369dd1116fc4ab21148461",
  measurementId: "G-XHXNGLQBFH"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const $ = id => document.getElementById(id);

// Render slot info
function render(slot) {
  const status = slot.status || "free";
  const arrival = slot.arrivalTime || "â€”";
  const leaving = slot.leavingTime || "â€”";

  $("slotCard").innerHTML = `
    <h2>Slot S1</h2>
    <p>Status: <span class="status ${status}">${status.toUpperCase()}</span></p>
    <p>Arrival: ${arrival}</p>
    <p>Leaving: ${leaving}</p>
  `;
}

// Update map based on location input
let map, geocoder, marker;
function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {center:{lat:-1.2921,lng:36.8219}, zoom:15});
  geocoder = new google.maps.Geocoder();
  marker = new google.maps.Marker({map:map});
}
function updateMap() {
  const loc = $("location").value;
  if (!loc) return;
  geocoder.geocode({address: loc}, function(results, status) {
    if (status === "OK") {
      map.setCenter(results[0].geometry.location);
      marker.setPosition(results[0].geometry.location);
    } else {
      alert("Location not found");
    }
  });
}

// Listen to Firebase
db.ref("slots/S1").on("value", snap => {
  render(snap.val() || {});
});

window.onload = initMap;
</script>
</body>
</html>
